!function(){"use strict";const e="Music_Diver_score.csv";class t{music_id;title;artist;genre;score_easy=0;status_easy="";rank_easy="";score_normal=0;status_normal="";rank_normal="";score_hard=0;status_hard="";rank_hard="";score_extreme=0;status_extreme="";rank_extreme="";constructor(e,t,r,n){this.music_id=e,this.title=t,this.artist=r,this.genre=n}}function r(e){return e.epic_count>0?"ALL CRITICAL":e.all_perfect_count>0?"ALL PERFECT":e.full_combo_count>0?"FULL COMBO":e.clear_count>=0?"CLEAR":"FAILED"}function n(e){return e.rank_sss_count>0?"SSS":e.rank_ss_count>0?"SS":e.rank_s_count>0?"S":e.rank_a_count>0?"A":e.rank_b_count>0?"B":e.rank_c_count>0?"C":e.rank_d_count>0?"D":e.rank_e_count>0?"E":""}alert("データ集計を開始します。");const s=function(e){let s=[];for(const c of e){let e=-1;for(let t=0;t<s.length;t++)if(s[t].music_id===c.music_id){e=t;break}if(-1===e){const r=new t(c.music_id,c.music_title,c.artist_name,c.genre_name);e=s.push(r)-1}switch(c.difficulty_id){case 0:s[e].score_easy=c.score,s[e].status_easy=r(c),s[e].rank_easy=n(c);break;case 1:s[e].score_normal=c.score,s[e].status_normal=r(c),s[e].rank_normal=n(c);break;case 2:s[e].score_hard=c.score,s[e].status_hard=r(c),s[e].rank_hard=n(c);break;case 3:s[e].score_extreme=c.score,s[e].status_extreme=r(c),s[e].rank_extreme=n(c)}}return s}(function(){try{const e=new XMLHttpRequest;return e.open("GET","https://mypage.musicdiver.jp/api/record_result?lang=ja",!1),e.send(),JSON.parse(e.response).response.play_result_list}catch(e){throw alert("Error: データの取得に失敗しました。"),Error("Error: データの取得に失敗しました。")}}());!function(t){!function(e){if(0===e.length)throw alert("Error: 参照データが存在しません。"),Error("Error: 参照データが存在しません。")}(t),console.info("filename:",e);const r=function(e){const t=Object.keys(e[0]),r=e.map((e=>t.map((t=>e[t]))));let n=[].concat([t],r);console.log(n);let s=function(e){return'"'+(""+e).replace(/"/g,'""')+'"'};return n.map((e=>e.map((e=>s(e))).join(","))).join("\n")}(t);!function(t){const r=new Uint8Array([239,187,191]),n=new Blob([r,t],{type:"text/csv"}),s=(window.URL||window.webkitURL).createObjectURL(n);let c=document.createElement("a");c.download=decodeURI(e),c.href=s,c.type="text/csv",c.click()}(r)}(s)}();
